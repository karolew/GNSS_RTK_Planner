<div class="debug-card">
    <form class="debug-form">
        <input type="text" name="endpoint" value="/rover" />
        <button data-action="read">Get Data</button>
        <button data-action="clear">Clear</button>
    </form>
    <pre>
        <code>{{ config }}</code>
    </pre>
</div>

<style>
    pre {
        white-space: pre-wrap;
    }
</style>

<script>
    function getData(endpoint, callback) {
        const request = new XMLHttpRequest();
        request.onreadystatechange = () => {
            if (request.readyState === 4) {
                callback(request.response);
            }
        };
        request.open("GET", endpoint);
        request.send();
    }

    class DebugForm {
        constructor() {
            this.debug_card = document.querySelector(".debug-card");
            this.form = this.debug_card.querySelector(".debug-form");

            this.clear_button = this.form.querySelector("button[data-action='clear']");
            this.clear_button.addEventListener("click", this.handleClearClick.bind(this));

            this.read_button = this.form.querySelector("button[data-action='read']");
            this.read_button.addEventListener("click", this.handleReadClick.bind(this));
        }

        handleClearClick(event) {
            event.preventDefault();
            let code = this.debug_card.querySelector("code");
            code.innerText = "";
        }

        handleReadClick(event) {
            event.preventDefault();
            const debugCard = document.querySelector(".debug-card");
            const input = debugCard.querySelector("input")
            const endpoint = input.value;
            getData(endpoint, this.showResponse);
        }

        showResponse(data) {
            const debugCard = document.querySelector(".debug-card");
            let code = debugCard.querySelector("code");
            code.innerText = data;
        }
    }

    new DebugForm();
</script>